# 🌱 우리아이도서관 (woorilib) 고도화 구현 계획

> **작성일**: 2026-01-19
> **목표**: "우리 아이 책, 현명하게 골라 합리적으로 구해요"의 핵심 가치 극대화

---

## 📋 조사 결과 요약

### 1. 도서관 실시간 대출 정보 ❌ 불가
- 도서관정보나루 API는 **빅데이터 기반 통계 데이터**
- 실시간 대출 가능 여부는 각 도서관 자체 시스템에만 존재
- **결론**: 대출 상태 표시 안함. **"소장 여부"만 표시**

### 2. 알라딘 중고매장 재고 ⚠️ 주의 필요
- 실시간으로 관리되지만 **100% 정확하지 않음**
- "검색에 있다고 나와도 막상 서가에서 없는 경우 간혹 있음" ([나무위키 참조](https://namu.wiki/w/알라딘%20중고서점))
- 원인: 다른 손님이 엉뚱한 곳에 꽂아둠, 도난, 전산 오류 등
- **결론**: 사용하되, **"재고 상태는 변동될 수 있습니다" 안내 문구 필수**

### 3. 당근마켓 API/모니터링 ❌ 불가
- **공식 API 없음** ([SharedIT 참조](https://www.sharedit.co.kr/qnaboards/24830))
- 크롤링은 이용약관 위반 + 법적 문제 가능성
- 차단 위험 높고, 사이트 구조 변경 시 대응 어려움
- **결론**: 단순 검색 링크 제공만 유지. 가격대 예측 안 함.

### 4. 네이버/알라딘 가격 정보 ✅ 가능
- **네이버 검색 API**: 도서 정가/판매가 조회 가능
- **알라딘 API (usedList)**: 중고 가격 정보 조회 가능
  - `aladinUsed` (알라딘직배송 최저가)
  - `userUsed` (회원직배송 최저가)
  - `spaceUsed` (광활한우주점 최저가)

---

## 🎯 핵심 의사결정

| 항목 | 결정 | 이유 |
|------|------|------|
| 대출 상태 표시 | ❌ 안함 | 실시간 아님, 사용자 신뢰 손상 위험 |
| 소장 도서관 수 | ✅ 표시 | 신뢰도 높음, 대여 수월함 지표로 활용 |
| 알라딘 중고 재고 | ⚠️ 주의 문구와 함께 표시 | 유용하지만 100% 정확 아님 |
| 당근마켓 가격 예측 | ❌ 안함 | API 없음, 크롤링 불법 위험 |
| 당근마켓 알림 | ❌ 안함 | 기술적/법적으로 불가 |
| 반납 예정일 알림 | ❌ 안함 (또는 사용자 입력) | 자동화 불가, 사용자 부담 |
| 책 교환 제안 | ❌ 보류 | 채팅 등 구현 범위 너무 큼 |
| 음성/이미지 검색 | ❌ 안함 | 구현 난이도 대비 필요성 낮음 |

---

## 🏗️ 구현 계획

### Phase 1: 핵심 기능 강화 (우선순위 높음)

#### 1.1 도서관 지도 뷰 ⭐⭐⭐
**목표**: 소장 도서관을 지도에서 직관적으로 확인

**구현 내용**:
- 카카오맵 연동 (library-finder의 `LibraryMap.tsx` 참조)
- 도서관 위치 마커 표시 (이미 위경도 데이터 있음)
- 사용자 위치 기반 가까운 순서 정렬
- "이 지역에서 다시 검색" 기능

**표시 정보**:
```
🏛️ 도서관 (광명시 8개 소장)
├─ 📍 광명시립도서관 (1.2km) - 소장중
├─ 📍 철산도서관 (2.1km) - 소장중
├─ 📍 하안도서관 (3.5km) - 소장중
└─ 💡 상호대차로 가까운 곳에서 받을 수 있어요!
```

**소장 도서관 수에 따른 UX**:
| 소장 수 | 표시 | 의미 |
|---------|------|------|
| 0개 | 🔴 "우리 지역 미소장" | 구하기 어려움 |
| 1~3개 | 🟡 "소장 도서관 N개" | 대여 가능성 있음 |
| 4개 이상 | 🟢 "대여 수월해요!" | 쉽게 구할 수 있음 |

**베스트셀러 처리**:
- 베스트셀러는 소장 도서관 많아도 대출 중일 확률 높음
- 표시: "🔥 인기 도서 - 예약이 필요할 수 있어요"
- 대안 제시: "중고로 구하면 더 빠를 수 있어요"

**참조 파일**:
- `library-finder/features/library-map/ui/LibraryMap.tsx`
- `library-finder/features/library-map/lib/use-map-store.ts`

---

#### 1.2 알라딘 중고 가격 정보 ⭐⭐⭐
**목표**: 온라인 중고 최저가를 API로 직접 조회

**구현 내용**:
- `ItemLookUp` API에 `OptResult=usedList` 추가
- 알라딘직배송/회원직배송 최저가 표시
- 오프라인 매장 재고는 **링크만 제공** (100% 신뢰 어려움)

**표시 예시**:
```
📖 알라딘 중고
├─ 💰 온라인 최저가: 5,500원 (정가 12,000원)
│   └─ 알라딘직배송 / 무료배송
└─ 🏪 오프라인 매장 재고 확인하기 →
    ⚠️ 재고는 변동될 수 있으니 방문 전 전화 확인 권장
```

**주의 문구 (필수)**:
- 오프라인 재고: "재고 상태는 변동될 수 있습니다"
- 매장 전화번호 함께 제공

---

#### 1.3 가족 관리 (다자녀 지원) ⭐⭐⭐
**목표**: 여러 자녀의 책장과 독서 기록 분리 관리

**구현 내용**:
- 자녀 프로필 CRUD (이름, 생년월일, 아바타)
- 자녀별 책장 분리
- 자녀별 독서 통계
- 자녀 전환 UI (탭 또는 드롭다운)

**데이터 구조**:
```typescript
interface FamilyMember {
  id: string;
  name: string;
  birthDate: string; // 나이 자동 계산
  avatar: string; // 이모지 또는 아이콘
  createdAt: string;
}
```

**참조 파일**:
- `library-finder/features/family/model/use-family-store.ts`
- `library-finder/features/family/api/family.service.ts`

---

#### 1.4 절약 계산기 ⭐⭐⭐
**목표**: "이번 달 얼마나 절약했는지" 보여주기

**핵심 문제 해결**:
> "사용자가 실제 얼마에 샀는지 모르는데 어떻게?"

**해결책**: 획득 방법별 **추정 절약률** 적용

| 획득 방법 | 추정 절약률 | 근거 |
|-----------|-------------|------|
| 🏛️ 도서관 | 100% (정가 전액) | 무료 |
| 🥕 당근마켓 | 70% (정가의 30% 지출 추정) | 일반적인 중고 거래가 |
| 📖 알라딘 중고 | 50% (정가의 50% 지출 추정) | 평균 중고가 |
| 🛒 새책 | 10% (할인율 추정) | 온라인 평균 할인 |

**사용자 입력 방식**:
- 책 완독 시 "어떻게 구했나요?" 선택
- 선택지: 도서관 / 당근·중고 / 새책 / 선물받음 / 이미 있던 책

**표시 예시**:
```
🎉 이번 달 독서 리포트

📚 읽은 책: 8권
💵 정가 합계: 96,000원
✅ 추정 절약: 72,000원!

📊 획득 방법별
├─ 🏛️ 도서관: 5권 (60,000원 절약)
├─ 🥕 중고: 2권 (8,400원 절약)
└─ 🛒 새책: 1권 (1,200원 절약)
```

**정가 정보 출처**: 알라딘 API `pricestandard` 필드

---

### Phase 2: 사용자 경험 개선

#### 2.1 간편 독서 기록 ⭐⭐⭐
**목표**: 엄마가 최대한 쉽게 기록할 수 있도록

**핵심 문제 해결**:
> "엄마가 자녀 독서 기록 입력하는 게 귀찮음"

**해결책**: 최소 탭으로 기록 완료

**방법 1: 책 상세 페이지에서 바로 기록**
```
[책 상세 페이지]
         ↓
[❤️ 읽었어요] 버튼 탭
         ↓
[자녀 선택] → [감상 선택 (선택)] → 완료!
```

**방법 2: 바코드 스캔 (카메라 API 활용)**
- 책 뒷면 ISBN 바코드 스캔
- 자동으로 책 정보 조회 → 바로 기록
- 구현 난이도: 중간 (Web API 사용)

**감상 선택 (선택사항)**:
- 😆 재미있었어요
- ❤️ 감동이었어요
- 🤔 어려웠어요
- 😴 지루했어요
- ⏭️ 건너뛰기

**참조 파일**:
- `library-finder/features/reading-record/lib/use-reading-record.ts`

---

#### 2.2 비슷한 책 추천 ⭐⭐
**목표**: "이 책 좋아하면 이것도 좋아할 거예요"

**구현 방법**: 도서관나루 `recommandList` API 활용

**API 스펙**:
```
GET /api/recommandList?isbn13={ISBN}&type=reader
→ "이 책을 빌린 사람들이 함께 빌린 책" 목록 반환
```

**표시 예시**:
```
📚 이 책을 좋아한 아이들이 함께 읽은 책
├─ 슈퍼 토끼 (85% 일치)
├─ 구름빵 (72% 일치)
└─ 더보기 →
```

---

#### 2.3 PWA 설정 ⭐⭐
**목표**: 홈 화면에 앱처럼 추가

**구현 내용**:
```typescript
// app/manifest.ts
export default function manifest() {
  return {
    name: '우리아이도서관',
    short_name: '우리아이도서관',
    description: '우리 아이 책, 현명하게 골라 합리적으로 구해요',
    start_url: '/',
    display: 'standalone',
    background_color: '#FFFEF5',
    theme_color: '#2E7D32',
    icons: [{ src: '/icon-512.png', sizes: '512x512', type: 'image/png' }],
  };
}
```

**참조 파일**:
- `library-finder/app/manifest.ts`

---

### Phase 3: 소셜 & 게이미피케이션

#### 3.1 동네 커뮤니티 ⭐⭐
**목표**: 같은 지역 부모들의 책 추천 공유

**구현 내용**:
- 지역별 인기 도서 랭킹 (도서관나루 API 활용)
- 간단한 한줄평 기능
- "우리 동네 N명이 읽었어요" 표시

**범위 제한** (채팅 없이):
- 댓글/대화 기능 없음
- 책에 대한 한줄평만 가능
- 신고 기능으로 부적절 콘텐츠 관리

---

#### 3.2 또래 비교 ⭐⭐
**목표**: 또래 아이들과 독서량 비교

**구현 내용**:
- 연령대별 평균 독서량 계산 (우리 서비스 사용자 기반)
- "상위 N%" 표시
- 동기부여 메시지

**표시 예시**:
```
👶 5세 또래 비교

📚 이번 달 우리 아이: 8권
📊 5세 평균: 4.2권
🏆 상위 15%!

"대단해요! 계속 이대로 읽어주세요 💪"
```

---

#### 3.3 독서 챌린지 & 뱃지 ⭐⭐
**목표**: 재미있게 독서 습관 형성

**챌린지 예시**:
- 📚 이번 주 3권 읽기
- 🌈 다양한 주제 5가지 도전
- 🏛️ 도서관에서 5권 빌리기
- 📖 새로운 작가 책 읽기

**뱃지 시스템**:
| 뱃지 | 조건 |
|------|------|
| 🌱 첫 독서 | 첫 책 기록 |
| 📚 독서왕 | 월 10권 이상 |
| 💰 알뜰왕 | 50,000원 절약 |
| 🏛️ 도서관 마스터 | 도서관으로 20권 |
| 🔥 연속 독서 | 7일 연속 기록 |

---

### Phase 4: 시각화 & UX 개선

#### 4.1 독서 타임라인 ⭐
**목표**: 아이의 독서 성장 기록

**표시 내용**:
- 연도별/월별 읽은 책 갤러리
- "3세 때 이런 책을 읽었어요"
- 책 표지 그리드 뷰

---

#### 4.2 빠른 액션 버튼 ⭐
**목표**: 검색 결과에서 바로 행동

**구현 내용**:
```
[검색 결과 카드]
├─ 책 표지 + 제목
├─ [❤️] [🏛️] [📤] 버튼
│    │     │     └─ 공유
│    │     └─ 도서관 찾기
│    └─ 책장 담기
└─ 탭하면 상세 페이지
```

---

## 📁 library-finder에서 가져올 파일

| 기능 | 파일 경로 | 우선순위 |
|------|----------|---------|
| 카카오맵 | `features/library-map/ui/LibraryMap.tsx` | P0 |
| 지도 상태관리 | `features/library-map/lib/use-map-store.ts` | P0 |
| 가족 스토어 | `features/family/model/use-family-store.ts` | P0 |
| 가족 API | `features/family/api/family.service.ts` | P0 |
| 독서 기록 | `features/reading-record/lib/use-reading-record.ts` | P0 |
| 독서 통계 UI | `features/my-bookshelf/ui/reading-stats.tsx` | P1 |
| PWA 매니페스트 | `app/manifest.ts` | P1 |
| 연령별 추천 | `features/kids-mode/lib/kids-book.service.ts` | P2 |

---

## 🚫 구현 안 함 (명확한 사유)

| 기능 | 이유 |
|------|------|
| 실시간 대출 상태 | API 미지원, 신뢰도 문제 |
| 당근마켓 가격 예측 | API 없음, 신뢰할 수 없음 |
| 당근마켓 알림 | 크롤링 불법 위험 |
| 반납 예정일 자동 알림 | 자동화 불가, 사용자 부담 |
| 책 교환 제안 | 채팅 등 구현 범위 너무 큼 |
| 음성/이미지 검색 | 구현 난이도 대비 필요성 낮음 |
| 비즈니스 확장 | 보류 |

---

## 📅 구현 순서 제안

### Sprint 1 (1주차): 핵심 인프라
- [ ] 알라딘 API 키 문제 해결
- [ ] 알라딘 중고 가격 API 연동 (usedList)
- [ ] 가족 관리 기능 (다자녀)

### Sprint 2 (2주차): 지도 & UX
- [ ] 카카오맵 도서관 지도 뷰
- [ ] 소장 도서관 수 기반 UX 개선
- [ ] 빠른 액션 버튼

### Sprint 3 (3주차): 기록 & 통계
- [ ] 간편 독서 기록 (2탭 완료)
- [ ] 절약 계산기
- [ ] PWA 설정

### Sprint 4 (4주차): 소셜 & 게임
- [ ] 비슷한 책 추천 (recommandList)
- [ ] 또래 비교
- [ ] 독서 챌린지 & 뱃지

---

## ✅ 체크리스트

### 알라딘 재고 관련 필수 안내 문구
- [ ] "재고 상태는 변동될 수 있습니다"
- [ ] "방문 전 전화 확인을 권장합니다"
- [ ] 매장 전화번호 함께 표시

### 절약 계산기 관련
- [ ] "추정 절약 금액입니다" 안내
- [ ] 획득 방법 선택 UI
- [ ] 정가 정보 알라딘 API에서 가져오기

### 베스트셀러 처리
- [ ] "🔥 인기 도서" 뱃지 표시
- [ ] "예약이 필요할 수 있어요" 안내
- [ ] 중고 구매 대안 제시

---

## 📚 참고 자료

- [도서관정보나루 API](https://www.data4library.kr/openDataL)
- [알라딘 Open API](https://blog.aladin.co.kr/openapi)
- [네이버 검색 API](https://developers.naver.com/docs/serviceapi/search/book/book.md)
- [알라딘 중고매장 재고 정확도](https://namu.wiki/w/알라딘%20중고서점)
- [당근마켓 API 불가 사유](https://www.sharedit.co.kr/qnaboards/24830)
